<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Видео на сайте | WebReference</title>
<meta charset="utf-8" />
<link rel="up" href="../diveintohtml5.html" />
<link rel="next" href="geolocation.html" />
<link rel="prev" href="canvas.html" />
<meta name="description" content="Любой, кто посещал YouTube.com за последние четыре года знает, что можно вставить видео на веб-страницу. До HTML5 не существовало стандартного способа сделать это, фактически, любое видео, что вы видели в Интернете, было добавлено через сторонние плагины вроде QuickTime, RealPlayer или Flash (на YouTube используется именно он). Эти плагины достаточно хорошо интегрированы с браузером, поэтому вы могли даже не знать, что их используете. Но это до тех пор, пока не попытаетесь посмотреть видео на платформе без поддержки плагина. HTML5 определяет стандартный способ вставки видео на веб-страницу с помощью элемента . Поддержка все ещё развивается и это вежливый способ сказать, что он пока не работает, по крайней мере, работает не везде. Но не отчаиваетесь! Есть альтернативные способы добавления, причём в изобилии." />
<link rel="canonical" href="video.html" />
<link type="text/css" rel="stylesheet" href="../../assets/css/css_GmPV_e3YNAzxsGyZNJb8l3jyzuLiXRRwUYoy5enMRkM.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../assets/css/css_2H3Dgnhk-GMIhlAAevncWEQeqNkZ7SjzqGb8OfLzzuU.css" media="screen" />
</head>
<body>
<main>
<div class="off-canvas-wrap" data-offcanvas><div class="inner-wrap"><header><div class="row"><div class="small-12 large-4 columns logo"><a href="../../index.html">WebReference<span>.</span>ru</a></div><nav class="small-10 large-7 columns topmenu"><div class="region region-menu"><div id="system-main-menu" class="block"><div class="block_content"><ul class="menu"><li class="first leaf"><a href="../../ref.html" title="">Справочники</a></li><li class="leaf"><a href="../../layout.html" title="">Вёрстка</a></li><li class="leaf"><a href="../../dev.html" title="">Веб-технологии</a></li><li class="leaf"><a href="../../mobile.html" title="">Мобильные приложения</a></li><li class="last leaf"><a href="../../course.html">Курсы</a></li></ul></div></div></div></nav><div class="small-2 large-1 columns search"><div id="search-button"></div><form action="https://webref.ru/search/" id="cse-search-box"><input type="search" placeholder="Поиск по сайту" name="s" autocomplete="off" id="cse-search-input"><input type="hidden" name="cx" value="partner-pub-0708135098984815:9970767379"><input type="hidden" name="cof" value="FORID:10"><input type="hidden" name="ie" value="UTF-8"></form></div></div></header><div class="title"><div class="row"><div class="small-12 columns"><h1>Видео на сайте</h1></div></div></div><div class="breadcrumb"><div class="row"><div class="small-12 columns"><div class="region region-crumbs"><div id="easy_breadcrumb-easy_breadcrumb" class="block"><div class="block_content"><div class="easy-breadcrumb"><a href="../../index.html" class="easy-breadcrumb_segment easy-breadcrumb_segment-front">Главная</a><span class="easy-breadcrumb_segment-separator"> / </span><a href="../../layout.html" class="easy-breadcrumb_segment easy-breadcrumb_segment-1">Вёрстка</a><span class="easy-breadcrumb_segment-separator"> / </span><a href="../diveintohtml5.html" class="easy-breadcrumb_segment easy-breadcrumb_segment-2">Погружение в HTML5</a><span class="easy-breadcrumb_segment-separator"> / </span><span class="easy-breadcrumb_segment easy-breadcrumb_segment-title">Видео на сайте</span></div></div></div></div></div></div></div><div class="row"><div class="medium-12 large-9 columns main-section"><div class="region region-content"><div id="system-main" class="block"><p>Любой, кто посещал YouTube.com за последние четыре года знает, что можно вставить видео на веб-страницу. До HTML5 не существовало стандартного способа сделать это, фактически, любое видео, что вы видели в Интернете, было добавлено через сторонние плагины вроде QuickTime, RealPlayer или Flash (на YouTube используется именно он). Эти плагины достаточно хорошо интегрированы с браузером, поэтому вы могли даже не знать, что их используете. Но это до тех пор, пока не попытаетесь посмотреть видео на платформе без поддержки плагина.</p><p>HTML5 определяет стандартный способ вставки видео на веб-страницу с помощью элемента <span class="tag">&lt;video&gt;</span>. Поддержка <span class="tag">&lt;video&gt;</span> все ещё развивается и это вежливый способ сказать, что он пока не работает, по крайней мере, работает не везде. Но не отчаиваетесь! Есть альтернативные способы добавления, причём в изобилии.</p><table class="browser data"><caption>Поддержка элемента &lt;video&gt;</caption><tr class="br"><td><span class="ie">IE</span></td><td><span class="fx">Firefox</span></td><td><span class="sa">Safari</span></td><td><span class="cr">Chrome</span></td><td><span class="op">Opera</span></td><td><span class="ip">iPhone</span></td><td><span class="an">Android</span></td></tr><tr><td>9.0+</td><td>3.5+</td><td>3.0+</td><td>3.0+</td><td>10.5+</td><td>1.0+</td><td>2.0+</td></tr></table><p>Поддержка <span class="tag">&lt;video&gt;</span> в действительности лишь малая часть проблемы. Прежде, чем мы поговорим об HTML5-видео, вам в первую очередь необходимо понять о самом видео.</p><h2>Контейнеры видео</h2><p>Вы можете думать о видеофайлах как об «AVI» или «MP4». В действительности, «AVI» и «MP4» только форматы файлов. Подобно ZIP-архиву, в котором может храниться любой файл, видеоформаты определяют способ хранения, а не данные. В действительности все несколько сложнее из-за того, что потоковое видео не всегда совместимо с форматами контейнеров, но это пока не важно.</p><p>Видеофайл обычно содержит несколько дорожек&nbsp;— видеодорожка (без звука), а также одну или несколько звуковых дорожек (без видео). Дорожки, как правило, взаимосвязаны, звуковая дорожка содержит маркеры для синхронизации аудио с видео. Дополнительные дорожки могут содержать метаданные, такие как соотношение сторон видео или язык звуковой дорожки. Контейнеры также могут содержать метаданные, такие как название самого видео, обложку, номер эпизода (для сериалов) и др.</p><p>Существует много форматов контейнеров видео, вот некоторые самые популярные.</p><ul><li><a href="http://ru.wikipedia.org/wiki/MPEG4" class="ext">MPEG-4</a>, обычно с расширением mp4 или m4v. MPEG-4 основан на <a href="http://www.chiariglione.org/mpeg/technologies/mp04-ff/index.htm">старом контейнере Apple QuickTime</a> (файлы с расширением mov). <a href="http://www.apple.com/trailers/">Трейлеры к фильмам на сайте Apple</a> по-прежнему используют старый контейнер, но фильмы в iTunes поставляются в формате контейнера MPEG-4.</li><li><a href="http://ru.wikipedia.org/wiki/Ogg" class="ext">Ogg</a>, обычно с расширением ogv. Ogg является открытым стандартом с открытым исходным кодом для пользователей, свободным от каких-либо патентов. Браузеры Firefox&nbsp;3.5, Chrome&nbsp;4 и Opera&nbsp;10.5 имеют встроенную поддержку без специальных плагинов&nbsp;— контейнера Ogg, Ogg-видео (называемое «Theora») и Ogg-аудио (называемое «Vorbis»). Ogg поддерживается всеми основными дистрибутивами Linux, также можно использовать его на Mac и Windows, установив соответственно <a href="http://www.xiph.org/quicktime/">компоненты QuickTime</a> или <a href="http://www.xiph.org/dshow/">фильтры DirectShow</a>. Плеер <a href="http://www.videolan.org/vlc/">VLC</a> превосходно проигрывает Ogg-файлы на любой платформе.</li><li><a href="http://ru.wikipedia.org/wiki/Flash_Video" class="ext">Flash-видео</a>, обычно с расширением flv. Для Flash-видео используется Adobe Flash, что не удивительно. До Flash 9.0.60.184 (по-другому Flash Player 9 Update 3) поддерживался только контейнер в формате Flash. Поздние версии также поддерживают контейнер MPEG-4.</li><li><a href="http://ru.wikipedia.org/wiki/WebM" class="ext">WebM</a>, обычно с расширением webm. Является открытым стандартом, свободным от каких-либо патентов и разработан специально для использования с HTML5 видео, усилен видеокодеком VP8 и аудиокодеком Vorbis. Технически похож на другой формат, называемый <a href="http://en.wikipedia.org/wiki/Matroska">Matroska</a>. Поддерживается изначально, без отдельных плагинов, в последних версиях Google Chrome, Mozilla Firefox и Opera.</li><li><a href="http://en.wikipedia.org/wiki/Advanced_Systems_Format">ASF</a>, как правило, с расширением .asf. Формат контейнера ASF был изобретён Microsoft для потокового видео. Включала <a href="http://www.theinquirer.net/inquirer/news/1027669/microsoft-media-player-shreds-rights">восхитительную схему DRM</a>, которая ограничивала пользователям резервное копирование своих легально приобретённых лицензий. Таким образом, если по какой-то причине вы потеряли лицензию на содержимое, считали, что вы должны купить её ещё раз.</li><li><a href="http://ru.wikipedia.org/wiki/Audio_Video_Interleave" class="ext">Audio Video Interleave</a>, как правило, с расширением avi. Формат контейнера AVI был изобретён Майкрософт в то время, когда считалось удивительным, что компьютеры вообще могут проигрывать видео. Особенности последних форматов файлов вроде метаданных официально не поддерживаются. Также этот формат официально не поддерживает большинство используемых современных аудио и видеокодеков. Он является форматом по умолчанию для популярных кодировщиков вроде MEncoder.</li></ul><h2>Видеокодеки</h2><p>Когда вы говорите о «просмотре видео», речь, вероятно, идёт о сочетании одного потока видео и одного аудиопотока. Но у вас нет двух разных файлов, есть «видео». Это может быть AVI-файл или MP4-файл, который всего лишь является форматом контейнера наподобие ZIP-архива, содержащего внутри себя несколько видов файлов. Формат контейнера определяет, как хранить видео и аудиопотоки в одном файле.</p><p>Когда вы смотрите видео, ваш плеер делает три вещи одновременно:</p><ol><li>Интерпретирует формат контейнера, узнаёт, какие аудио и видеодорожки доступны, как они хранятся в файле, чтобы можно было найти данные.</li><li>Декодирует видеопоток и отображает серию изображений на экране.</li><li>Декодирует аудиопоток и отправляет звук на колонки.</li></ol><p>Видеокодек это алгоритм, по которому кодируется видеопоток, он указывает, как сделать пункт&nbsp;2 из списка выше. Слово «кодек» происходит от сочетания слов «кодер» и «декодер». Ваш видеоплеер декодирует видеопоток в зависимости от видеокодека, а затем отображает серию изображений или «кадров» на экране. Большинство современных видеокодеков использует всевозможные уловки для минимизации объёма информации, необходимого для отображения следующего кадра. Например, вместо хранения каждого отдельного кадра они будут хранить только различия между кадрами. Большинство видео на самом деле не изменяется целиком при переходе от одного кадра к другому, что позволяет хорошо сжимать данные, в результате получаются файлы меньшего размера.</p><p>Существуют видеокодеки с потерей данных и без потерь. Видео без потерь слишком большое, чтобы быть полезным в Интернете, поэтому я сконцентрируюсь на видео с потерями. Видеокодек с потерей означает, что информация во время кодирования безвозвратно утеряна. Это похоже на копирование аудиокассеты, вы теряете информацию об исходном видео и получаете ухудшения качества каждый раз, когда кодируете. Вместо «свиста» аудиокассеты пере-пере-перекодированное видео может выглядеть как набор блоков, особенно в сценах с движением. На самом деле это может произойти даже при кодировании из первоисточника, если вы выбрали плохой кодек или указали неверные параметры. Хорошей стороной видеокодеков с потерями является удивительное сглаживание блоков во время воспроизведения, что делает потери менее заметными для человеческого глаза.</p><p>Есть <a href="http://samples.mplayerhq.hu/V-codecs/">куча видеокодеков</a>. Три наиболее подходящих это H.264, Theora и VP8.</p><h3>H.264</h3><p><a href="http://ru.wikipedia.org/wiki/H.264" class="ext">H.264</a> также известен как «MPEG-4 Part 10» или «MPEG-4 AVC» или «MPEG-4 Advanced Video Coding». H.264 был разработан <a href="http://en.wikipedia.org/wiki/Moving_Picture_Experts_Group">группой MPEG</a> и стандартизирован в 2003 году. Целью разработки было создание единого кодека для устройств от сотовых телефонов до современных настольных компьютеров. Для этого в стандарте H.264 имеются <a href="https://ru.wikipedia.org/wiki/H.264#.D0.9F.D1.80.D0.BE.D1.84.D0.B8.D0.BB.D0.B8">профили</a>, для каждого из которых определены дополнительные возможности влияющих на размер файла. Высшие профили используют несколько дополнительных функций, предлагают лучшее визуальное качество при меньших размерах файлов, но занимают больше времени для кодирования и требует больше ресурсов процессора для декодирования в реальном времени.</p><p>Чтобы дать вам примерное представление об ассортименте профилей, <a href="http://www.apple.com/iphone/specs.html">iPhone от Apple поддерживает профиль Baseline</a>, <a href="http://www.apple.com/appletv/specs.html">приставка AppleTV поддерживает профили Baseline и Main</a>, <a href="http://www.kaourantin.net/2007/08/what-just-happened-to-video-on-web_20.html">Adobe Flash на настольных компьютерах поддерживает профили Basic, Main и High</a>. YouTube использует H.264 для кодирования <a href="http://blog.wired.com/business/2008/12/youtube-adds-hd.html">видео высокого разрешения</a>, воспроизводимого через Adobe Flash; YouTube также предоставляет H.264-кодированное видео на мобильные устройства, включая iPhone от Apple и телефоны с <a href="http://code.google.com/android/">операционной системой Android</a>. Кроме того, H.264 является одним из видеокодеков, предусмотренных спецификацией Blu-Ray. Диски Blu-Ray используют в основном профиль High.</p><p>Большинство некомпьютерных устройств воспроизводящих H.264-видео (включая iPhone и бытовые Blu-Ray-проигрыватели) декодируют с помощью специального чипа, поскольку их основные процессоры не настолько мощны, чтобы декодировать видео в режиме реального времени. В наши дни даже бюджетные видеокарты имеют аппаратную поддержку декодирования H.264. Есть <a href="http://compression.ru/video/codec_comparison/mpeg-4_avc_h264_2007_en.html">конкурирующие с H.264 кодеки</a>, включая библиотеку с открытым кодом <a href="http://www.videolan.org/developers/x264.html">x264</a>. <strong>Стандарт H.264 основан на патенте</strong>, лицензирование происходит посредством группы <a href="http://www.mpegla.com">MPEG LA</a>. H.264 может быть вложен в наиболее популярные <a href="http://diveintohtml5.info/video.html#video-containers">форматы видео</a>, включая MP4 (используется в основном в <a href="http://www.apple.com/itunes/whatson/movies.html">магазине iTunes</a> компании Apple) и MKV (используется в основном энтузиастами видео).</p><h3>Theora</h3><p><a href="http://ru.wikipedia.org/wiki/Theora" class="ext">Theora</a> эволюционировал из <a href="http://en.wikipedia.org/wiki/Theora#History">кодека VP3</a> и был разработан <a href="http://xiph.org">Xiph.org Foundation</a><a href="http://xiph.org"></a>. <strong>Theora — свободный от отчисления кодек и не связан никакими известными патентами</strong> кроме оригинальных VP3-патентов, которые были лицензированы безвозмездно. Хотя стандарт был «заморожен» с 2004 года, проект Theora (включающий в себя кодер с открытым исходным кодом и декодер) <a href="http://lists.xiph.org/pipermail/theora-dev/2008-November/003736.html">выпустил версию 1.0 в ноябре 2008 года</a> и <a href="http://lists.xiph.org/pipermail/theora-dev/2009-September/003985.html">версию 1.1 в сентябре 2009 года</a>.</p><p>Видео Theora может быть встроено в любой формат файла, хотя чаще всего встречается в контейнере Ogg. Все основные дистрибутивы Linux поддерживают Theora из коробки, Mozilla Firefox 3.5 включает в себя <a href="https://developer.mozilla.org/En/Using_audio_and_video_in_Firefox">встроенную поддержку видео Theora</a> в контейнере Ogg. Вы также можете воспроизводить видео Theora в <a href="http://www.xiph.org/dshow/">Windows</a> или в <a href="http://xiph.org/quicktime/">Mac OS X</a> после установки открытого программного обеспечения Xiph.org.</p><h3>VP8</h3><p><a href="http://ru.wikipedia.org/wiki/VP8" class="ext">VP8</a> другой видеокодек от On2, той же компании, что первоначально разработала VP3 (позднее Theora). Технически по качеству он похож на базовый H.264 с большим потенциалом для будущих улучшений.</p><p>В 2010 году Google приобрел On2 и опубликовал спецификацию кодека и примеры как открытое программное обеспечение. В рамках этого Google также «открыл» все патенты, которые On2 зарегистрировала на VP8 и сделал их свободными от отчислений. Это лучшее, на что можно надеяться с патентами. Вы не можете на самом деле «освободить» их или свести на нет после того как они были выпущены. Чтобы сделать их открытыми для пользователей у вас должна быть лицензия без отчислений, после чего каждый может использовать технологию, ничего не платя и без заключения лицензионного соглашения. По состоянию на 19 мая 2010 года, VP8 является <strong>свободным от отчислений, современным кодеком не связанным никакими известными патентами</strong> кроме тех патентов, что On2 (в настоящее время Google) уже лицензировали безвозмездно.</p><h2>Аудиокодеки</h2><p>Если вы собираетесь смотреть фильмы, снятые после <a href="http://www.filmsite.org/jazz.html">1927 года</a>, то захотите звуковую дорожку. Подобно видеокодеку, аудиокодек это алгоритм, согласно которому кодируется аудиопоток. Подобно видеокодеку они делятся на аудиокодеки с потерями и без. И аналогично видео без потерь, аудио без потерь слишком большое, чтобы выкладывать его в Интернет. Так что я сконцентрируюсь на аудиокодеках с потерями.</p><p>На самом деле, их не так и много, потому что есть разные категории кодеков с потерями. Аудио используется в тех местах, где нет видео (телефония, например), также существует категория <a href="http://www.voip-info.org/wiki-Codecs">аудиокодеков оптимизированных для кодирования речи</a>. Вам не удалось бы конвертировать музыкальный компакт-диск с этими кодеками, поскольку результат бы звучал как пение четырехлетнего ребенка. Но вы должны использовать их в <a href="http://www.asterisk.org">Asterisk</a>, потому что ширина канала важна, а эти кодеки позволяют сжимать человеческую речь в разы по отношению к кодекам общего назначения. Тем не менее, из-за отсутствия поддержки в браузерах и сторонних плагинах, кодеки для оптимизации речи в реальности не используются в Интернете. Так что я сконцентрируюсь на общих аудиокодеках.</p><p>Как я уже упоминал выше, когда вы «смотрите видео», компьютер делает, по крайней мере, три вещи одновременно:</p><ul><li>интерпретирует формат контейнера;</li><li>декодирует видеопоток;</li><li>декодирует аудиопоток и направляет звук в колонки.</li></ul><p>Аудиокодек отвечает за пункт 3&nbsp;— декодирование аудиопотока и его преобразование в цифровые сигналы, которые динамики затем превращают в звук. Как и у видеокодеков имеются разные уловки для уменьшения объёма информации хранящейся в звуковом потоке.</p><p>И так как мы говорим о кодеках с потерями, информация теряется во время цикла запись&nbsp;→ кодирование&nbsp;→ декодирование&nbsp;→ прослушивание. Различные аудиокодеки отбрасывают разные вещи, но у них всех одна цель: обмануть ваши уши&nbsp;&#8212; сделать так, чтобы вы не замечали пропавших частей.</p><p>Отличие аудио от видео в каналах. Мы отправляем звук на колонки, так? Ну, как много у вас колонок? Если вы сидите за компьютером, то скорее у вас их только две: одна слева и одна справа. На моем столе три: слева, справа и еще одна на полу. Системы, называемые «звук вокруг», могут содержать шесть и более динамиков, стратегически расположенных по всей комнате. Каждый динамик получает свой канал исходной записи. В теории вы можете сидеть в середине шести динамиков, буквально окруженный шестью раздельными каналами звука и ваш мозг будет вызывать чувство, что вы находитесь в центре событий. Это возможно? Индустрия за несколько миллиардов долларов думает что да.</p><p>Большинство общих аудиокодеков могут работать с двумя каналами звука. Во время записи звук разделяется на левый и правый каналы, во время кодирования оба канала хранятся в том же звуковом потоке, во время декодирования оба канала декодируются и каждый из них направляется в соответствующий динамик. Некоторые аудиокодеки могут обрабатывать более двух каналов, они отслеживают каждый канал, чтобы плеер посылал правильный звук на правильный динамик.</p><p>Есть много аудиокодеков. Я уже говорил, что видеокодеков много? Забудьте. Есть <a href="http://wiki.multimedia.cx/index.php?title=Category:Audio_Codecs">уйма и уйма аудиокодеков</a>, но в Интернете вам надо знать только об MP3, AAC и Vorbis.</p><h3>MPEG-1 Audio Layer 3</h3><p><a href="http://ru.wikipedia.org/wiki/MP3" class="ext">MPEG-1 Audio Layer 3</a> известен как «MP3». Если вы ничего не слышали об MP3, то я не знаю что с вами делать. Интернет-магазины продают портативные музыкальные плееры и называют их «MP3-плееры». Вот так.</p><p>MP3 может содержать <strong>до двух каналов звука</strong>, которые могут быть закодированы с различным битрейтом: 64&nbsp;кбит/с, 128&nbsp;кбит/с, 192&nbsp;кбит/с и множество других от 32 до 320. Более высокий битрейт означает больший размер файлов и лучшее качество звука, хотя отношение битрейта к качеству звука не является линейным. 128&nbsp;кбит/с звучит более чем в два раза лучше, чем 64&nbsp;кбит/с, но 256 кбит/с не звучит в два раза лучше, чем 128&nbsp;кбит/с. Кроме того, формат MP3 позволяет делать переменный битрейт, это означает что некоторые части кодированного потока сжаты больше других. Например, тишина может быть закодирована с низким битрейтом, затем мгновение спустя битрейт может подскочить, когда начнут играть несколько инструментов. MP3 также может быть закодирован с постоянным битрейтом.</p><p>Стандарт MP3 не определяет как именно кодировать MP3 (хотя он точно определяет как его декодировать), различные кодировщики используют разные психоакустические модели, которые дают широкий разброс результатов. Открытый <a href="http://lame.sourceforge.net/">проект LAME</a> это лучший бесплатный кодировщик, за исключением самых низких битрейтов.</p><p>Формат MP3 (стандартизован в 1991) <strong>запатентован</strong>, что объясняет, почему Linux при установке из коробки не может проигрывать MP3-файлы. Почти каждый портативный музыкальный плеер поддерживает стандартные файлы MP3, аудиопоток в MP3 может быть встроен в любой <a href="http://web.archive.org/web/20100516164550/http://diveintomark.org/archives/2008/12/18/give-part-1-container-formats">видеоконтейнер</a>. Adobe Flash может играть и стандартные файлы MP3 и аудиопотоки MP3 в контейнере MP4-видео.</p><h3>Advanced Audio Coding</h3><p><a href="http://ru.wikipedia.org/wiki/Advanced_Audio_Coding" class="ext">Advanced Audio Coding</a> более известен как «AAC». Стандартизированный в 1997 году, он стал известным, когда Apple выбрал его в качестве основного формата для магазина iTunes.</p><p>Первоначально все AAC-файлы из магазина iTunes были зашифрованы фирменной DRM- схемой от Apple называемой <a href="http://en.wikipedia.org/wiki/FairPlay">FairPlay</a>. Избранные песни в iTunes теперь доступны как незащищённые AAC-файлы, их Apple называет «iTunes Плюс», потому что это звучит гораздо лучше, чем название «iTunes минус». <strong>Формат AAC запатентован</strong>, <a href="http://www.vialicensing.com/licensing/aac-fees.aspx">лицензионное соглашение доступно в Интернете</a>.</p><p>AAC был разработан, чтобы обеспечить лучшее качество звука чем MP3 при том же битрейте, и он может кодировать аудио в любой битрейт. MP3 ограничен фиксированным числом битрейтом с верхней границей 320&nbsp;кбит/с. AAC может кодировать <strong>до 48 каналов звука</strong>, хотя на практике этого никто не делает. Формат AAC также отличается от MP3 заданием нескольких профилей, пойдя тем же путем что и <a href="http://web.archive.org/web/20100510152646/http://diveintomark.org/archives/2008/12/19/give-part-2-lossy-video-codecs#h264">H.264</a>. Профиль «low-complexity» предназначен для воспроизведения в реальном времени на устройствах с ограниченной мощностью процессора, в то время как более сложные профили предлагают лучшее качество звука при том же битрейте за счёт более медленного кодирования и декодирования.</p><p>Все современные продукты Apple, включая iPod, AppleTV, QuickTime поддерживают определенные профили AAC в стандартных аудиофайлах и аудиопотоках в видеоконтейнере MP4. Adobe Flash поддерживает все профили в формате AAC в MP4.</p><h3>Vorbis</h3><p><a href="http://ru.wikipedia.org/wiki/Vorbis" class="ext">Vorbis</a> часто называют «Ogg Vorbis» хотя это технически неверно&nbsp;— «Ogg» это формат контейнера, а Vorbis аудиопоток, который может быть встроен в другие контейнеры. <strong>Vorbis не обременён никакими известными патентами</strong> и, следовательно, поддерживается всеми основными дистрибутивами Linux и портативными устройствами. Mozilla Firefox&nbsp;3.5 поддерживает Vorbis-аудио в контейнере Ogg или Ogg-видео с аудиодорожкой Vorbis. Мобильные телефоны на <a href="http://code.google.com/android/">Android</a> также могут воспроизводить стандартные аудиофайлы Vorbis. Аудиопоток Vorbis, как правило, встроен в контейнер Ogg или WebM, но он также может быть <a href="http://samples.mplayerhq.hu/MPEG-4/vorbis-in-mp4/">встроен в контейнер MP4</a> или <a href="http://en.wikipedia.org/wiki/Matroska">MKV</a> (а также с некоторыми хитростями в <a href="http://www.alexander-noe.com/video/amg/">AVI</a>). Vorbis поддерживает <strong>произвольное количество звуковых каналов</strong>.</p><p>Существуют свободные кодеры и декодеры Vorbis, в том числе <a href="http://oggconvert.tristanb.net/">OggConvert</a> (кодер), <a href="http://www.ffmpeg.org/">FFmpeg</a> (декодер), <a href="http://www.geocities.jp/aoyoume/aotuv/">aoTuV</a> (кодер) и <a href="http://downloads.xiph.org/releases/vorbis/">libvorbis</a> (декодер). Есть также <a href="http://www.xiph.org/quicktime/">компоненты QuickTime для Mac OS X</a> и <a href="http://www.xiph.org/dshow/">фильтры DirectShow для Windows</a>.</p><h2>Что работает на странице</h2><p>Если ваши глаза ещё окончательно не выпали, они у вас лучше, чем у большинства других. Как вы могли заметить, видео (и аудио) сложная тема, а ведь это ещё был сокращённый вариант! Я уверен, вам интересно как это всё относится к HTML5. Итак, HTML5 включает элемент <span class="tag">&lt;video&gt;</span> для встраивания видео на веб-страницу. Нет никаких ограничений на видеокодек, аудиокодек или формат файла, которые вы можете использовать для вашего видео. Один элемент <span class="tag">&lt;video&gt;</span> может содержать ссылки на несколько файлов, браузер же выберет первый файл, который он сможет воспроизвести. Это способ узнать, как браузеры поддерживают разные контейнеры и кодеки.</p><p>На момент написания статьи распространено следующее HTML5-видео.</p><ul><li>Mozilla Firefox 3.5+ поддерживает видео Theora и аудио Vorbis в контейнере Ogg. Firefox&nbsp;4+ также поддерживает WebM.</li><li>Opera 10.5+ поддерживает видео Theora и аудио Vorbis в контейнере Ogg. Opera 10.60+ также поддерживает WebM.</li><li>Google Chrome 3.0+ поддерживает видео Theora и аудио Vorbis в контейнере Ogg. Он также поддерживает видео H.264 (все профили) и аудио AAC (все профили) в контейнере MP4. Google Chrome 6.0+ также поддерживает WebM.</li><li>Safari на Маках и Windows (3.0 и выше) будет поддерживать всё, что поддерживает QuickTime. В теории вы могли бы потребовать, чтобы пользователи установили плагин QuickTime. В действительности лишь немногие пользователи это сделают. Так что остаются форматы, которые QuickTime поддерживает «из коробки». Это длинный список, но он не включает WebM, Theora, Vorbis или контейнер Ogg. Однако QuickTime поддерживает видео H.264 (основной профиль) и аудио AAC в контейнере MP4.</li><li>Мобильные телефоны вроде iPhone от Apple и на базе Google Android поддерживают видео H.264 (базовый профиль) и аудио AAC (профиль «low-complexity») в контейнере MP4.</li><li> Adobe Flash (9.0.60.184 и выше) поддерживает видео H.264 (все профили) и аудио AAC (все профили) в контейнере MP4.</li><li>Internet Explorer 9+ поддерживает все профили видео H.264 и аудио AAC или MP3 в контейнере MP4. Он также будет воспроизводить WebM, если вы установите сторонний кодек, который отсутствует по умолчанию в любой версии Windows. IE не поддерживает другие сторонние кодеки (в отличие от Safari, который воспроизводит всё, что понимает QuickTime).</li><li>Internet Explorer 8 не поддерживает HTML5-видео вообще, но практически у всех пользователей Internet Explorer установлен плагин Adobe Flash. Далее в этой главе я покажу вам, как вы можете использовать HTML5-видео и изящно обратиться к Flash.<br /></li></ul><p>Нагляднее представить всё в виде таблицы.</p><table class="browser data"><caption>Видеокодеки, поддерживаемые в текущих браузерах</caption><tr class="br"><td style="text-align: left">Кодек/контейнер</td><td><span class="ie">IE</span></td><td><span class="fx">Firefox</span></td><td><span class="sa">Safari</span></td><td><span class="cr">Chrome</span></td><td><span class="op">Opera</span></td><td><span class="ip">iPhone</span></td><td><span class="an">Android</span></td></tr><tr><td style="text-align: left">Theora+Vorbis+Ogg</td><td>–</td><td>3.5+</td><td>†</td><td>5.0+</td><td>10.5+</td><td>–</td><td>–</td></tr><tr><td style="text-align: left">H.264+AAC+MP4</td><td>9.0+</td><td>–</td><td>3.0+</td><td>5.0+</td><td>–</td><td>3.0+</td><td>2.0+</td></tr><tr><td style="text-align: left">WebM</td><td>9.0+*</td><td>4.0+</td><td>†</td><td>6.0+</td><td>10.6+</td><td>–</td><td>2.3+</td></tr></table><p style="font-size: 0.82em; margin-left: 2em">* Internet Explorer 9 будет поддерживать WebM, только если пользователь установил VP8 кодек.</p><p style="font-size: 0.82em; margin-left: 2em"> † Safari воспроизводит всё, что может играть QuickTime, но он работает только со встроенной комбинацией H.264/AAC/MP4.</p><p>А теперь удар нокаутом.</p><div class="profmarkup"><h4>Профессор Разметкин говорит</h4><div class="inner"><p>Нет единой комбинации контейнеров и кодеков, которая работает во всех HTML5-браузерах. И эта ситуация вряд ли изменится в ближайшем будущем.</p><p>Чтобы ваше видео можно было смотреть на всех устройствах и платформах, придётся кодировать видео несколько раз.</p></div></div><p>Для обеспечения максимальной совместимости рабочий процесс с вашим видео будет следующим.</p><ul><li>Сделать одну версию с помощью WebM (VP8 + Vorbis).</li><li>Сделать ещё одну версию, которая использует видео с базовым профилем H.264 и аудио AAC с профилем «low-complexity» в контейнере MP4.</li><li>Сделать ещё одну версию, которая использует видео Theora и аудио Vorbis в контейнере Ogg. WebM и H.264 имеют достаточную поддержку. Так что если вы не собираетесь поддерживать Firefox&nbsp;3.5 или Opera&nbsp;10.5, можно отбросить Theora.</li><li>В одном элементе <span class="tag">&lt;video&gt;</span> поставить ссылку на все три видеофайла и предусмотреть откат к плееру на Flash.</li></ul><h2>Вопросы лицензирования видео H.264</h2><p>Прежде чем мы продолжим, я должен отметить, что стоимость кодирования видео оплачивается два раза. Так, есть очевидная стоимость, когда вы хотите кодировать видео дважды, тогда требуется больше компьютеров и времени, чем для одного раза. Но есть и другая стоимость связанная с видео H.264&nbsp;— это затраты на лицензирование.</p><p>Помните, когда я впервые объяснял про H.264 я заикался, что видеокодек запатентован и лицензируется при посредничестве консорциума MPEG LA. Это важное отклонение, для понимания этой важности я направляю вас на <a href="http://www.streamingmedia.com/Articles/Editorial/Featured-Articles/The-H.264-Licensing-Labyrinth-65403.aspx" class="ext">The H.264 Licensing Labyrinth</a><span style="font-family:'Linux Libertine'; color:black; ">.</span></p><blockquote><p>MPEG LA разделяет лицензию H.264 на две сублицензии: одну для производителей кодеров или декодеров, а другую для поставщиков...</p><p>Сублицензия для поставщиков разделяется на четыре основных подкатегории, две из которых (подписка и платное использование) связаны с тем, что конечный пользователь непосредственно платит за видео сервисы, а ещё две («бесплатное» телевидение и интернет-трансляция) связаны с вознаграждением из других источников, а не от зрителя...</p><p>Лицензионный сбор за «свободное» телевидение основан на одном из двух вариантов платежа. Первый это одноразовый платеж в размере $2500 за кодировщика передачи «используемый от имени лицензиата в передаче видео конечному пользователю», который будет декодировать и просматривать видео. Если вам интересно, является ли это двойной платой, ответ да: лицензионный сбор уже внесён в кодирующее устройство производителя, а телекомпании, в свою очередь платят один из двух вариантов роялти.</p><p>Второй лицензионный платеж это плата за ежегодное вещание, которая зависит от размеров аудитории:</p><ul><li>$2500 за один календарный год трансляции при аудитории 100.000–499.999 человек.</li><li>$5.000 за календарный год трансляции при аудитории 500.000–999.999 человек.</li><li>$10.000 за один календарный год трансляции при аудитории 1.000.000 человек и более.</li></ul><p>Как я упоминал ранее, плата за участие применяется к любому способу доставки контента. После определения, что «свободное» телевидение означает больше, чем обычное (по воздуху), MPEG LA установил частичную плату за интернет-вещание, так как «видео, которое поставляется через Интернет по всему миру, не оплачивается конечным пользователем за право на передачу или просмотр». Другими словами, любое вещание, является ли оно обычным, кабельным, спутниковым или через Интернет подлежит оплате...</p><p>Сборы потенциально несколько выше для интернет-трансляций, предполагая, что доступ через Интернет будет расти гораздо быстрее, чем традиционное или «свободное» телевидение, такое как кабельное или спутниковое. Добавляя «бесплатное телевидение» в рынок вещания вместе с дополнительной оплатой, MPEG LA гарантирует отсрочку в течение первого срока лицензии, который заканчивается 31 декабря 2010 года, и отмечает, что «после первого срока роялти должен быть не более, чем экономический эквивалент лицензионного платежа в течение того же времени для свободного телевидения.</p></blockquote><p>В последнюю часть&nbsp;— о структуре платы для интернет-трансляций&nbsp;— уже были внесены поправки. MPEG-LA недавно <a href="http://www.mpegla.com/Lists/MPEG LA News List/Attachments/226/n-10-02-02.pdf">объявила</a>, что для потокового вещания не потребуется отчислений. Это не означает что H.264 является безвозмездным для всех пользователей. В частности, кодеры (подобные тому, что обрабатывает видео, выложенное на YouTube) и декодеры (как включенный в браузер Google Chrome) все ещё являются предметом лицензионных сборов. Смотрите <a href="http://shaver.off.net/diary/2010/08/27/free-as-in-smokescreen/" class="ext">Free as in smokescreen</a> для получения дополнительной информации.</p><h2>Наконец, разметка</h2><p>Я вполне уверен, что это должна быть книга по HTML. Тогда где разметка?</p><p>HTML5 предоставляет вам два способа включения видео на веб-страницу и оба связаны с элементом <span class="tag">&lt;video&gt;</span>. Если у вас есть только один видеофайл, вы можете дать ссылку на него в атрибуте <span class="attribute">src</span>. Это очень похоже на добавление изображения через <span class="var">&lt;img src=&quot;...&quot;&gt;</span>.</p>
  <pre><code data-language="html">&lt;video <mark>src=&quot;pr6.webm&quot;</mark>&gt;&lt;/video&gt;</code></pre>
<p>Технически это всё что вам нужно. Но подобно элементу <span class="tag">&lt;img&gt;</span> вы должны всегда включать атрибуты <span class="attribute">width</span> и <span class="attribute">height</span> в <span class="tag">&lt;video&gt;</span>. Атрибуты <span class="attribute">width</span> и <span class="attribute">height</span> могут совпадать с максимальной шириной и высотой, которую вы указали во время процесса кодирования. Не беспокойтесь, если одна из сторон видео немного меньше указанных значений, ваш браузер центрирует видео внутри прямоугольника заданного элементом <span class="tag">&lt;video&gt;</span>. Пропорции видео никогда не будут искажены.</p>
<pre><code data-language="html">&lt;video src=&quot;pr6.webm&quot; <mark>width=&quot;320&quot; height=&quot;240&quot;</mark>&gt;&lt;/video&gt;</code></pre>
  <p> По умолчанию для элемента <span class="tag">&lt;video&gt;</span> не добавляются кнопки управления. Вы можете создать собственные элементы управления со старым добрым HTML, CSS, и JavaScript. Для <span class="tag">&lt;video&gt;</span> действуют такие методы как <span class="var">play()</span> и <span class="var">pause ()</span>, а также свойство <span class="var">currentTime</span>. Есть также свойства <span class="var">volume</span> и <span class="var">muted</span>. Так что вы имеете всё необходимое для создания своего собственного интерфейса.</p><p>Если вы не желаете создавать свой интерфейс, то можете сказать браузеру вывести встроенные элементы управления. Для этого просто включите атрибут <span class="attribute">controls</span> в <span class="tag">&lt;video&gt;</span>.</p>
  <pre><code data-language="html"> &lt;video src=&quot;pr6.webm&quot; width=&quot;320&quot; height=&quot;240&quot; <mark>controls</mark>&gt;&lt;/video&gt;</code></pre>
  <p> Есть ещё два дополнительных атрибута, о которых я хотел бы упомянуть, прежде чем мы пойдём дальше: <span class="attribute">preload</span> и <span class="attribute">autoplay</span>. Не стреляйте в посланника, позвольте мне вначале объяснить, почему они полезны. Атрибут <span class="attribute">preload</span> сообщает браузеру, что вы хотели бы начать загрузку видеофайлов, как только страница загрузится. Это имеет смысл, если страница предназначена для просмотра важного видео. С другой стороны, если это просто дополнительный материал, то лишь немногие посетители будут его смотреть, тогда вы можете установить <span class="attribute">preload</span> как <span class="value">none</span>, чтобы сказать браузеру снизить сетевой трафик.</p><p>Вот пример видео, которое начинает загрузку (но не воспроизведение), как только загрузится страница.</p>
  <pre><code data-language="html">&lt;video src=&quot;pr6.webm&quot; width=&quot;320&quot; height=&quot;240&quot; <mark>preload</mark>&gt;&lt;/video&gt;</code></pre>
<p> А вот пример видео, которое не будет загружаться при загрузке страницы.</p>
  <pre><code data-language="html">&lt;video src=&quot;pr6.webm&quot; width=&quot;320&quot; height=&quot;240&quot; <mark>preload=&quot;none&quot;</mark>&gt;&lt;/video&gt;</code></pre>
  <p> Атрибут <span class="attribute">autoplay</span> делает именно то, как и звучит: говорит браузеру, что вы хотели бы начать загрузку видеофайла при загрузке страницы и желаете воспроизвести видео при возможности автоматически. Некоторые люди любят это, другие ненавидят. Но позвольте мне объяснить, почему этот атрибут важен в HTML5. Отдельные люди хотят, чтобы их видео воспроизводилось автоматически, даже если это раздражает их посетителей. Если HTML5 не определяет стандартный способ автоматического воспроизведения видео, люди начнут прибегать к JavaScript, чтобы сделать это в любом случае. Например, вызывать метод <span class="var">play()</span> пока загружаются события окна. Посетителям было бы гораздо труднее противодействовать этому. С другой стороны, это упрощает добавление в расширение браузера (или написать сво` при необходимости) выражения «игнорировать атрибут <span class="attribute">autoplay</span>, я не желаю воспроизводить видео автоматически».</p><p>Вот пример видео, которое начнет загружаться и играть сразу же после загрузки страницы.</p>
  <pre><code data-language="html"> &lt;video src=&quot;pr6.webm&quot; width=&quot;320&quot; height=&quot;240&quot; <mark>autoplay</mark>&gt;&lt;/video&gt;</code></pre>
  <p> А вот скрипт Greasemonkey, который можно установить в вашей локальной копии Firefox для предотвращения автоматического воспроизведения HTML5-видео. Он использует DOM-атрибут <span class="attribute">autoplay</span> определённый в HTML5 и эквивалентный атрибуту <span class="attribute">autoplay</span> в коде HTML.</p>
  <pre><code data-language="html">var arVideos = document.getElementsByTagName('video');
for (var i = arVideos.length - 1; i &gt;= 0; i--) {
  var elmVideo = arVideos[i];
  <mark>elmVideo.autoplay = false;</mark>
}</code></pre>
  <p>Но подождите секунду... Если вы следовали этой главе, то у вас есть не один видеофайл, а три. Один это OGV-файл, второй MP4-файл, третий WebM-файл. HTML5 обеспечивает способ сделать ссылки на все три файла с помощью элемента <span class="tag">&lt;source&gt;</span>. Каждый элемент <span class="tag">&lt;video&gt;</span> может содержать более одного <span class="tag">&lt;source&gt;</span>. Ваш браузер пройдётся по списку источников видео по порядку и выберет первым то, что он в состоянии воспроизвести.</p><p>Возникает другой вопрос: как браузер узнает, какое видео он сможет воспроизвести? Ну, в худшем случае он загружает каждое видео и пытается его сыграть, однако это большая трата пропускной способности. Вы сэкономите много трафика, если сообщите браузеру информацию о каждом видео. Это можно сделать атрибутом <span class="attribute">type</span> элемента <span class="tag">&lt;source&gt;</span>.</p>
  <pre><code data-language="html">&lt;video width=&quot;320&quot; height=&quot;240&quot; controls&gt;
  &lt;<mark>source src=&quot;pr6.mp4&quot;</mark> type='video/mp4; codecs=&quot;avc1.42E01E, mp4a.40.2&quot;'&gt;
  &lt;<mark>source src=&quot;pr6.webm&quot;</mark> type='video/webm; codecs=&quot;vp8, vorbis&quot;'&gt;
  &lt;<mark>source src=&quot;pr6.ogv&quot;</mark> type='video/ogg; codecs=&quot;theora, vorbis&quot;'&gt;
&lt;/video&gt;</code></pre>
  <p>Давайте разберём это сверху вниз. Элемент <span class="tag">&lt;video&gt;</span> определяет ширину и высоту видео, но не ссылку на видеофайл. Внутри <span class="tag">&lt;video&gt;</span> содержится три элемента <span class="tag">&lt;source&gt;</span>. Каждый элемент <span class="tag">&lt;source&gt;</span> ссылается на отдельный видеофайл (с атрибутом <span class="attribute">src</span>), а также даёт информацию о видеоформате (в атрибуте <span class="attribute">type</span>).</p><p>Тип атрибута выглядит сложным, адски сложным. Это комбинация из трёх блоков информации: формат файла, видеокодек и аудиокодек. Давайте начнём с самого последнего. Для видеофайла .ogv формат контейнера — Ogg, представленный здесь как <span class="value">video/ogg</span>, строго говоря, это MIME-тип для видеофайлов Ogg. Видеокодек Theora и аудиокодек Vorbis. Это достаточно просто, кроме формата значение атрибута, он немного странный. Само значение должно быть заключено в кавычки, поэтому вы должны использовать различные виды кавычек, чтобы окружить значение целиком.</p>
<pre><code data-language="html">&lt;source src=&quot;pr6.ogv&quot; <mark>type='video/ogg; codecs=&quot;theora, vorbis&quot;'</mark>&gt;</code></pre>
<p> С WebM почти так же, но с другим MIME-типом (<span class="value">video/webm</span> вместо <span class="value">video/ogg</span>) и другим видеокодеком (<span class="value">vp8</span> вместо <span class="value">theora</span>) написанным в параметре <span class="attribute">codecs</span>.</p>
<pre><code data-language="html">&lt;source src=&quot;pr6.webm&quot; <mark>type='video/webm; codecs=&quot;vp8, vorbis&quot;'</mark>&gt;</code></pre>
<p> Видео H.264 является более сложным. Помните, я говорил, что видео H.264 и аудио AAC может быть в разных «профилях»? Мы кодируем H.264 с помощью «базового» профиля и AAC с профилем «low-complexity» и все это внутри контейнера MPEG-4. Вся информация, включенная в атрибут <span class="attribute">type</span>.</p>
  <pre><code data-language="html"> &lt;source src=&quot;pr6.mp4&quot; <mark>type='video/mp4; codecs=&quot;avc1.42E01E, mp4a.40.2&quot;'</mark>&gt;</code></pre>
  <p> Преимуществом всех этих сложностей является то, что браузер проверяет атрибут <span class="attribute">type</span> первым и смотрит, может ли он воспроизвести видеофайл. Если браузер решает, что он не может этого сделать, то не будет скачивать файл даже частично. Вы сэкономите на пропускной способности, а ваши посетители увидят видео, за которым они пришли, быстрее.</p><p>Если вы будете следовать инструкциям этой главы при кодировании видео, то можете просто скопировать и вставить значения атрибута <span class="attribute">type</span> из примеров. В противном случае, вам нужно выработать параметры <span class="attribute">type</span> для себя.</p><div class="profmarkup"><h4>Профессор Разметкин говорит</h4><div class="inner"><p>iPad на iOS 3.x содержал ошибку, из-за которой он не замечал ничего, кроме первого источника видео в списке. iOS 4 исправил эту ошибку. Если вы ориентируйтесь на владельцев старых устройств, то это означает, что вы должны указать ваш MP4-файл первым, а затем остальные видеоформаты. Эх.</p></div></div><div id="block-17" class="block"><div class="block_content">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-0708135098984815" data-ad-slot="1599783371" data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div></div><h2>MIME-типы поднимают свою уродливую голову</h2><p>Неправильно настроенный веб-сервер может привести к бесконечным разочарованиям, почему это ваши видео идут на локальном компьютере, но не воспроизводятся на рабочем сайте. Если вы столкнулись с этой проблемой, то причина вероятнее всего в MIME-типах.</p><p>Я уже упоминал про MIME-типы ранее, но вы, вероятно, прозевали и не оценили их значение. Так вот большими буквами.</p><div class="profmarkup"><h4>Профессор Разметкин говорит</h4><div class="inner"><p>ВИДЕОФАЙЛЫ ДОЛЖНЫ БЫТЬ СОПОСТАВЛЕНЫ С СООТВЕТСТВУЮЩИМ MIME-ТИПОМ!</p></div></div><p>Что это за соответствующий MIME-тип? Вы уже видели его как часть значения атрибута <span class="attribute">type</span> у элемента <span class="tag">&lt;source&gt;</span>. Но добавление атрибута <span class="attribute">type</span> не является достаточным, вы также должны убедиться, что ваш веб-сервер включает в HTTP-заголовок <span class="var">Content-Type</span> соответствующий MIME-тип.</p><p>Если вы используйте веб-сервер Apache или его производные, то можете включить директиву <span class="var">AddType</span> в httpd.conf или файл .htaccess расположенный в той директории, где вы храните ваши видеофайлы. Если вы используете другой веб-сервер, обратитесь к документации вашего сервера о том, как установить HTTP-заголовок <span class="var">Content-Type</span> для определенных типов файлов.</p>
  <pre><code>  AddType video/ogg .ogv
  AddType video/mp4 .mp4
  AddType video/webm .webm</code></pre>
  <p>Первая строка предназначена для видео в контейнере Ogg. Вторая строка для видео в контейнере MPEG-4. Третья для WebM. Установите это один раз и забудьте. Если вы не указали эти директивы, ваше видео может не играть в некоторых браузерах, даже если включены MIME-типы в атрибуте <span class="attribute">type</span> вашего HTML-кода.</p><p>Для суровых подробностей по настройке веб-сервера, я обращаю ваше внимание на эту прекрасную статью в Mozilla Developer Center: <a href="https://developer.mozilla.org/en/Configuring_servers_for_Ogg_media" class="ext">Configuring servers for Ogg media</a>. Советы в этой статье также относятся к видео MP4 и WebM.</p><h2>Что насчет IE?</h2><p><a href="http://msdn.microsoft.com/en-us/ie/ff468705.aspx#_HTML5_video_audio">Internet Explorer&nbsp;9 поддерживает</a> элемент <span class="tag">&lt;video&gt;</span>, но Microsoft публично пообещал, что финальная версия IE 9 будет поддерживать видео H.264 и аудио AAC в формате контейнера MPEG-4, как Safari и iPhone.</p><p>Но как насчёт более старых версий Internet Explorer до IE8 включительно? У большинства людей, которые используют Internet Explorer также установлен плагин Adobe Flash. Современные версии Adobe Flash (начиная с 9.0.60.184) поддерживают видео H.264 и аудио AAC в формате контейнера MPEG-4, как Safari и iPhone. После того как вы кодировали видео H.264 для Safari, вы можете проиграть его во Flash-плеере, если обнаружится что у одного из посетителей не HTML5-браузер.</p><p>Flash-видеоплеер <a href="http://flowplayer.org" class="ext">FlowPlayer</a> это программа с открытым кодом по GPL-лицензии (коммерческая лицензия также доступна). FlowPlayer ничего не знает об элементе <span class="tag">&lt;video&gt;</span>, он не будет волшебным образом преобразовывать тег <span class="tag">&lt;video&gt;</span> во Flash-объект. Но HTML5 хорошо продуман, чтобы обойти эту проблему, поэтому вы можете вложить элемент <span class="tag">&lt;object&gt;</span> внутрь <span class="tag">&lt;video&gt;</span>. Браузеры, которые не поддерживают HTML5-видео, будут игнорировать элемент <span class="tag">&lt;video&gt;</span> и просто отображать вложенный <span class="tag">&lt;object&gt;</span> который ссылается на плагин Flash и показывает кино через FlowPlayer. Браузеры, поддерживающие HTML5-видео, обнаружат источник видео, который они могут воспроизвести и проигнорируют вложенный элемент <span class="tag">&lt;object&gt;</span>.</p><p>Это последний ключ ко всей головоломке: HTML5 указывает, что все элементы (кроме <span class="tag">&lt;source&gt;</span>) внутри <span class="tag">&lt;video&gt;</span> должны игнорироваться. Это позволяет использовать HTML5-видео в новых браузерах и красиво откатить к Flash в старых браузерах, без каких-либо трюков с JavaScript. Вы можете почитать об этой технике здесь: <a href="http://camendesign.com/code/video_for_everybody" class="ext">Video For Everybody</a><span style="font-family:'Linux Libertine'; color:black; ">. </span></p><h2>Проблемы с iPhone и iPad</h2><p>iOS это операционная система Apple для iPhone, iPod Touche и iPad. iOS 3.2 имеет ряд проблем с HTML5-видео.</p><ul><li>iOS не распознает видео, если вставлен атрибут <span class="attribute">poster</span>. Этот атрибут элемента <span class="tag">&lt;video&gt;</span> позволяет отображать произвольное изображение при загрузке видео или пока пользователь нажимает на кнопку «играть». Эта ошибка исправлена в iOS 4.0, но пройдёт какое-то время пока пользователи обновятся.</li><li>Если у вас несколько элементов <span class="tag">&lt;source&gt;</span>, iOS признает лишь первый в списке. Устройства с iOS поддерживают только H.264 + AAC + MP4, это фактически означает, что вы всегда должны указывать MP4-файл в первую очередь. Эта ошибка также исправлена в iOS 4.0.</li></ul><h2>Проблемы с устройствами на базе Android</h2><p>Android — это операционная система Google для разных телефонов и карманных устройств. Android (до версии 2.3) имеет ряд проблем с HTML5-видео.</p><ul><li>Атрибут <span class="attribute">type</span> элемента <span class="tag">&lt;source&gt;</span> порядочно &laquo;смущает&raquo; Android. Единственный способ заставить его признать источник видео это по иронии судьбы вообще опустить атрибут <span class="attribute">type</span> и убедиться, что имя вашего видеофайла H.264 + AAC + MP4 заканчивается расширением .mp4. Это, кажется, не влияет на способность любого другого браузера определять поддержку видео; при отсутствии атрибута <span class="attribute">type</span> другие браузеры смотрят на расширение файла. Вы еще можете включить атрибут <span class="attribute">type</span> для других источников видео, так как H.264 является единственным форматом видео, который поддерживается устройствами Android на данный момент.</li><li>Атрибут <span class="attribute">controls</span> не поддерживается и Android не будет отображать любые элементы управления для видео. Вам будет нужно обеспечить собственные элементы управления пользовательского интерфейса. Как минимум, вы должны сделать скрипт, который начинает проигрывать видео, когда пользователь на него нажимает.</li></ul><h2>И наконец, живой пример</h2><p>В окончательном коде используется элемент <span class="tag">&lt;video&gt;</span>, вложенный элемент <span class="tag">&lt;object&gt;</span> для резервного Flash и небольшой скрипт для устройств на Android.</p>
<pre><code data-language="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Видео&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;video id=&quot;movie&quot; width=&quot;400&quot; height=&quot;320&quot; preload controls&gt;
      &lt;source src=&quot;video/snowman.mp4&quot;&gt;
      &lt;source src=&quot;video/snowman.webm&quot; type='video/webm; codecs=&quot;vp8, vorbis&quot;'&gt;
      &lt;source src=&quot;video/snowman.ogv&quot; type='video/ogg; codecs=&quot;theora, vorbis&quot;'&gt;
      &lt;object id=&quot;flowplayer&quot; type=&quot;application/x-shockwave-flash&quot; 
                              width=&quot;400&quot; height=&quot;320&quot;&gt;
        &lt;param name=&quot;movie&quot; value=&quot;video/flowplayer-3.2.5.swf&quot;&gt; 
        &lt;param name=&quot;flashvars&quot; value='config={&quot;clip&quot;:&quot;video/snowman.mp4&quot;}'&gt;
        &lt;p&gt;Загрузить видео в &lt;a href=&quot;video/snowman.mp4&quot;&gt;MP4&lt;/a&gt;, 
           &lt;a href=&quot;video/snowman.ogv&quot;&gt;OGG&lt;/a&gt; или 
           &lt;a href=&quot;video/snowman.webm&quot;&gt;WebM&lt;/a&gt;&lt;/p&gt;
      &lt;/object&gt;    
    &lt;/video&gt;
    &lt;script&gt;
      var v = document.getElementById(&quot;movie&quot;);
      v.onclick = function() {
        if (v.paused) {
          v.play();
        } else {
          v.pause();
        }
      };
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>

<p>При сочетании HTML5 и Flash вы сможете смотреть это видео практически на любом устройстве и браузере.</p><video id="movie" width="400" height="320" preload controls class=fig> <source src="https://webref.ru/example/video/snowman.mp4"> <source src="https://webref.ru/example/video/snowman.webm" type='video/webm; codecs="vp8, vorbis"'> <source src="https://webref.ru/example/video/snowman.ogv" type='video/ogg; codecs="theora, vorbis"'/></video><h2>Дальнейшее чтение</h2><ul><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/video.html#video" hreflang="en">HTML5: The &lt;video&gt; element</a></li><li><a href="http://camendesign.com/code/video_for_everybody" hreflang="en">Video for Everybody</a></li><li><a href="http://web.archive.org/web/20100527215322/http://diveintomark.org/tag/give" hreflang="en">A gentle introduction to video encoding</a></li><li><a href="http://hacks.mozilla.org/2009/09/theora-1-1-released/" hreflang="en">Theora 1.1 is released — what you need to know</a></li><li><a href="https://developer.mozilla.org/en/Configuring_servers_for_Ogg_media" hreflang="en">Configuring servers for Ogg media</a></li><li><a href="http://www.mplayerhq.hu/DOCS/HTML/en/menc-feat-x264.html" hreflang="en">Encoding with the x264 codec</a></li><li><a href="http://wiki.whatwg.org/wiki/Video_type_parameters" hreflang="en">Video type parameters</a></li><li><a href="http://dev.opera.com/articles/view/everything-you-need-to-know-about-html5-video-and-audio/" hreflang="en">Everything you need to know about HTML5 audio and video</a></li><li><a href="http://www.broken-links.com/2010/07/08/making-html5-video-work-on-android-phones/" hreflang="en">Making HTML5 video work on Android phones</a></li><li><a href="http://msdn.microsoft.com/en-us/ie/ff468705.aspx#_HTML5_video_audio" hreflang="en">Internet Explorer 9 Guide for Developers: HTML5 video and audio elements</a></li></ul><p>Создание своего управления для видео:</p><ul><li><a href="http://videojs.com/" hreflang="en">VideoJS</a></li><li><a href="http://mediaelementjs.com/" hreflang="en">MediaElement.js</a></li><li><a href="http://www.kaltura.org/project/HTML5_Video_Media_JavaScript_Library" hreflang="en">Kaltura HTML5 Video &amp; Media JavaScript Library</a></li></ul><div id="views-similar-block" class="block"><h2 class="block_title">См. также</h2><div class="block_content"><div class="view view-similar view-id-similar view-display-id-block view-dom-id-5e5c10dabb1cee80307366f61d8ac735"><div class="view-content"><div class="similar"><ul><li class=""> <a href="../../html/source.html">&lt;source&gt;</a></li><li class=""> <a href="../../html/track.html">&lt;track&gt;</a></li><li class=""> <a href="../../html/video.html">&lt;video&gt;</a></li><li class=""> <a href="../learn-html-css/adding-media.html">Добавление медиа-контента</a></li></ul></div></div></div></div></div><section class="row credit"><div class="columns small-6 credit-author"><i class="icon-user"></i> Автор: Марк Пилгрим</div><div class="columns small-6 credit-changed"><i class="icon-calendar"></i> Последнее изменение: 18.12.2015</div><div class="columns small-12 credit-editor"><i class="icon-users"></i> Редакторы: Влад Мержевич, Клим Щербаков</div></section><script src="../../sites/all/themes/ori/js/mousetrap.min.js"></script>
<script>
Mousetrap.bind('mod+left', function()   { document.location ='/layout/diveintohtml5/canvas'; });Mousetrap.bind('mod+right', function() { document.location = '/layout/diveintohtml5/geolocation'; });</script>
<div class="book-navigation row" id="book-navigation-bottom"><div class="small-6 columns page-previous"><a href="canvas.html" title="На предыдущую страницу">Давайте порисуем</a><br><span class="navigation-tooltip"><kbd>Ctrl</kbd>+<kbd>←</kbd></span></div><div class="small-6 columns page-next"><a href="geolocation.html" title="На следующую страницу">Вы здесь</a><br><span class="navigation-tooltip"><kbd>Ctrl</kbd>+<kbd>→</kbd></span></div></div><div id="block-9" class="block"><div class="block_content">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
ad = document.getElementById('block-9');
if (ad.getBoundingClientRect().width) {
adWidth = ad.getBoundingClientRect().width;
} else {
adWidth = ad.offsetWidth;
}
google_ad_client = "ca-pub-0708135098984815";
if (adWidth >= 728) { google_ad_size = ["728", "90"]; google_ad_slot = "1258944978"; }
else { google_ad_size = ["300", "250"]; google_ad_slot = "8016056172"; }
document.write (
'<ins class="adsbygoogle" style="display:inline-block;width:'
+ google_ad_size[0] + 'px;height:'
+ google_ad_size[1] + 'px" data-ad-client="'
+ google_ad_client + '" data-ad-slot="'
+ google_ad_slot + '"></ins>'
);
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div></div><div id="block-10" class="block"><div class="block_content"><div id="disqus_thread"></div>
<script>
var disqus_shortname = "webref";
(function() {
var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
(document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
})();
</script>
</div></div></div></div></div><aside class="large-3 columns right-off-canvas-menu"><div class="region region-sidebar-toc"><div id="book-navigation" class="block"><h2 class="block_title">Содержание</h2><div class="block_content"><ul class="menu"><li class="first leaf"><a href="introduction.html">Пять вещей, которые надо знать об HTML5</a></li><li class="leaf"><a href="past.html">Довольно предвзятая история HTML5</a></li><li class="leaf"><a href="detect.html">Проверка технологий HTML5</a></li><li class="leaf"><a href="semantics.html">Что всё это значит?</a></li><li class="leaf"><a href="canvas.html">Давайте порисуем</a></li><li class="leaf active-trail"><a href="video.html" class="active-trail active">Видео на сайте</a></li><li class="leaf"><a href="geolocation.html">Вы здесь</a></li><li class="leaf"><a href="storage.html">Локальное хранилище</a></li><li class="leaf"><a href="offline.html">Возьмём с собой</a></li><li class="leaf"><a href="forms.html">Сумасшедшие формы</a></li><li class="leaf"><a href="extensibility.html">Микроданные</a></li><li class="last leaf"><a href="history.html">Управление историей для пользы и развлечения</a></li></ul></div></div><div id="block-12" class="block"><div class="block_content">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:inline-block;width:200px;height:200px" data-ad-client="ca-pub-0708135098984815" data-ad-slot="4025987772"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div></div></div></aside></div><div class="adv_footer"><div class="row"><div class="medium-12 hide-for-medium-down"><div class="region region-adv-footer"><div id="block-15" class="block"><div class="block_content">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
ad = document.getElementById('block-15');
if (ad.getBoundingClientRect().width) {
adWidth = ad.getBoundingClientRect().width;
} else {
adWidth = ad.offsetWidth;
}
google_ad_client = "ca-pub-0708135098984815";
if (adWidth >= 728) { google_ad_size = ["728", "90"]; google_ad_slot = "1258944978"; }
else { google_ad_size = ["300", "250"]; google_ad_slot = "8016056172"; }
document.write (
'<ins class="adsbygoogle" style="display:inline-block;width:'
+ google_ad_size[0] + 'px;height:'
+ google_ad_size[1] + 'px" data-ad-client="'
+ google_ad_client + '" data-ad-slot="'
+ google_ad_slot + '"></ins>'
);
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div></div></div></div></div></div><a class="exit-off-canvas"></a></div></div><div class="copyright"><div class="row"><div class="small-2 columns"><p><a href="http://creativecommons.org/licenses/by-nc/4.0/deed.ru" rel="nofollow"><img alt="Лицензия Creative Commons" src="../../sites/all/themes/ori/img/cc.png" width="88" height="31"></a></p></div><div class="small-10 columns"><p>Все материалы сайта доступны по <a href="http://creativecommons.org/licenses/by-nc/4.0/deed.ru" rel="nofollow">лицензии Creative Commons «Attribution-NonCommercial» («Атрибуция — Некоммерческое использование») 4.0 Всемирная</a>, если не указано иное.</p></div></div></div><footer><div class="row"><div class="medium-12 large-4 columns"><h4>О сайте</h4><p>На сайте находятся справочники по различным веб-технологиям, а также руководства по вёрстке веб-страниц и разработке мобильных приложений.</p><p class="about-last">Главный редактор: Влад Мержевич</p></div><div class="small-6 large-2 columns"><h4>Связи</h4><ul id="community"><li><i class="icon-rss"></i> <a href="https://feeds.feedburner.com/webref" rel="nofollow">RSS</a></li><li><i class="icon-jsfiddle"></i> <a href="https://jsfiddle.net/user/webref/fiddles/" rel="nofollow">JSFiddle</a></li><li><i class="icon-github"></i> <a href="https://github.com/webref" rel="nofollow">GitHub</a></li><li><i class="icon-vk"></i> <a href="https://vk.com/webref" rel="nofollow">ВКонтакте</a></li><li><i class="icon-doc-text"></i> <a href="https://drive.google.com/folderview?id=0B4u62HGG7TOnTVJ4aFlFa1Jpb2M" rel="nofollow">Google Диск</a></li></ul></div><div class="small-6 large-3 columns"><h4>Разделы сайта</h4><ul id="footer-menu" class="links"><li><i class="icon-book"></i> <a href="../../ref.html">Справочники</a></li><li><i class="icon-layout"></i> <a href="../../layout.html">Вёрстка</a></li><li><i class="icon-gear"></i> <a href="../../dev.html">Веб-технологии</a></li><li><i class="icon-mobile"></i> <a href="../../mobile.html">Мобильные приложения</a></li><li><i class="icon-bookmark"></i> <a href="../../course.html">Учебные курсы</a></li></ul></div><div class="small-12 medium-12 large-3 columns"><h4>Популярные материалы</h4><div class="region region-popular"><div id="views-popular-popular" class="block"><div class="block_content"><div class="view view-popular view-id-popular view-display-id-popular view-dom-id-cf1939a57fd7bcdee295416832af3bb9"><div class="view-content"><ul><li class="leaf"> <img class="svg-img size-icon" data-src="/assets/svgimg/icon/img-styles/images/thumb/html5.svg.png" src="../../assets/images/thumb/html5.svg" width="16" height="16" alt="" /> <a href="../learn-html-css.html">Уроки по HTML и CSS</a></li><li class="leaf"> <img class="svg-img size-icon" data-src="/assets/svgimg/icon/img-styles/images/thumb/html5.svg.png" src="../../assets/images/thumb/html5.svg" width="16" height="16" alt="" /> <a href="../howtocodeinhtml.html">Как верстать на HTML5 и CSS3</a></li><li class="leaf"> <img class="svg-img size-icon" data-src="/assets/svgimg/icon/img-styles/images/thumb/html5.svg.png" src="../../assets/images/thumb/html5.svg" width="16" height="16" alt="" /> <a href="../html5-css3.html">HTML5 и CSS3 на примерах</a></li><li class="leaf"> <img class="svg-img size-icon" data-src="/assets/svgimg/icon/img-styles/images/thumb/css3.svg.png" src="../../assets/images/thumb/css3.svg" width="16" height="16" alt="" /> <a href="../magic-of-css.html">Магия CSS</a></li><li class="leaf"> <img class="svg-img size-icon" data-src="/assets/svgimg/icon/img-styles/images/thumb/jquery.svg.png" src="../../assets/images/thumb/jquery.svg" width="16" height="16" alt="" /> <a href="../../dev/jqfundamentals.html">Основы jQuery</a></li></ul></div></div></div></div></div></div></div><div class="row"><div class="small-12 columns counter">
<script src="../../sites/all/themes/ori/js/li.js"></script>
</div></div><a href="video.html#top"><div class="row"><div class="small-12 columns ontop">Наверх</div></div></a></footer></main>	
<script type="text/javascript" src="../../assets/js/js_cDfSr2FXPXcK1gvn1bGJotjGggYy9AyIYPQ5Hw_Sx7s.js"></script>
<script type="text/javascript" src="../../assets/js/js_H7q2xORKmR9AN8Qx5spKEIBp7R_wG2apAswJoCUZY7I.js"></script>
<script type="text/javascript" src="../../assets/js/js_Xmre84srNMv9IsL3EsmaMioO7AzocdnCMpWwTIu-jp8.js"></script>
<script type="text/javascript" src="../../assets/js/js_WCzLp6JdBrd-C4nO79XBCCg40n8pNJ8KLyzqGIFUryg.js"></script>
</body>
</html>